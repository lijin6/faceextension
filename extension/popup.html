<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>äººè„¸æƒ…ç»ªæ£€æµ‹ç³»ç»Ÿ</title>
    <style>
        body {
            width: 550px;
            min-height: 450px;
            margin: 0;
            padding: 15px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        h1 {
            font-size: 18px;
            color: #333;
            margin: 0 0 10px 0;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .mode-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            background-color: #e0e0e0;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .mode-btn:hover {
            background-color: #d0d0d0;
        }
        
        .mode-btn.active {
            background-color: #4a6ee0;
            color: white;
        }
        
        .mode-section {
            display: none;
        }
        
        .preview-area {
            margin: 10px 0;
            text-align: center;
            position: relative;
            background: #000;
            border-radius: 4px;
            overflow: hidden;
            max-height: 250px;
            min-height: 200px;
        }
        
        #preview, #videoPreview, #cameraPreview {
            max-width: 100%;
            max-height: 250px;
            display: block;
        }
        
        #videoPreview {
            width: 100%;
        }
        
        .control-btn {
            padding: 8px 15px;
            margin: 5px;
            background-color: #4a6ee0;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .control-btn:hover {
            background-color: #3a5bc0;
        }
        
        .control-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .control-group {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .real-time-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background: #e8f4ff;
            border-radius: 4px;
        }
        
        .video-progress {
            width: 100%;
            height: 20px;
            background: #eee;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .video-progress-fill {
            height: 100%;
            background: #4a6ee0;
            border-radius: 10px;
            transition: width 0.3s;
            width: 0%;
        }
        
        .status {
            padding: 8px 12px;
            margin: 10px 0;
            border-radius: 4px;
            font-size: 13px;
            display: none;
        }
        
        .status.success {
            background-color: #d4edda;
            color: #155724;
            display: block;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            display: block;
        }
        
        .status.info {
            background-color: #d1ecf1;
            color: #0c5460;
            display: block;
        }
        
        .result-section {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            background: white;
            max-height: 200px;
            overflow-y: auto;
            font-size: 13px;
        }
        
        .config {
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .config label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        .config input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        input[type="file"] {
            width: 100%;
            padding: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .analysis-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px;
            background: #e8f4ff;
            border-radius: 4px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ­ äººè„¸æƒ…ç»ªæ£€æµ‹ç³»ç»Ÿ</h1>
        
        <div class="mode-selector">
            <button class="mode-btn active" data-mode="image">ğŸ“· å›¾ç‰‡æ£€æµ‹</button>
            <button class="mode-btn" data-mode="video">ğŸ¬ è§†é¢‘æ£€æµ‹</button>
            <button class="mode-btn" data-mode="camera">ğŸ¥ å®æ—¶æ‘„åƒå¤´</button>
        </div>
        
        <!-- å›¾ç‰‡æ¨¡å¼ -->
        <div id="imageSection" class="mode-section active">
            <input type="file" id="imageInput" accept="image/*">
            <div class="preview-area">
                <img id="preview" alt="å›¾ç‰‡é¢„è§ˆ" style="display:none;">
            </div>
            <div class="control-group">
                <button id="analyzeImageBtn" class="control-btn" disabled>ğŸ” åˆ†æå›¾ç‰‡</button>
            </div>
        </div>
        
        <!-- è§†é¢‘æ¨¡å¼ -->
        <div id="videoSection" class="mode-section">
            <input type="file" id="videoInput" accept="video/*">
            <div class="preview-area">
                <video id="videoPreview" controls style="display:none;"></video>
            </div>
            
            <div class="analysis-info" id="videoInfo" style="display:none;">
                <span>è§†é¢‘æ—¶é•¿: <span id="videoDuration">0</span>ç§’</span>
                <span>å·²åˆ†æ: <span id="videoProgress">0</span>/<span id="videoTotalFrames">0</span>å¸§</span>
            </div>
            
            <div class="video-progress" id="videoProgressBar" style="display:none;">
                <div class="video-progress-fill" id="videoProgressFill"></div>
            </div>
            
            <div class="control-group">
                <button id="analyzeVideoBtn" class="control-btn" disabled>ğŸ” åˆ†æè§†é¢‘</button>
                <button id="stopVideoBtn" class="control-btn" disabled style="background-color: #f44336;">â¹ï¸ åœæ­¢</button>
            </div>
        </div>
        
        <!-- æ‘„åƒå¤´æ¨¡å¼ -->
        <div id="cameraSection" class="mode-section">
            <div class="preview-area">
                <video
                    id="cameraPreview"
                    autoplay
                    muted
                    playsinline
                    style="display:none;"
                ></video>
            </div>
            
            <div class="control-group">
                <button id="startCameraBtn" class="control-btn">â–¶ï¸ å¼€å¯æ‘„åƒå¤´</button>
                <button id="stopCameraBtn" class="control-btn" disabled>â¹ï¸ åœæ­¢</button>
                <button id="captureFrameBtn" class="control-btn" disabled>ğŸ“¸ å•å¸§åˆ†æ</button>
            </div>
            
            <div class="real-time-control">
                <input type="checkbox" id="realTimeToggle" disabled>
                <label for="realTimeToggle" style="cursor: pointer;">
                    å¼€å¯å®æ—¶æ£€æµ‹ (æ¯ç§’æ£€æµ‹ä¸€æ¬¡)
                </label>
            </div>
        </div>

        
        <!-- APIè®¾ç½® -->
        <div class="config">
            <label>ğŸŒ åç«¯APIåœ°å€:</label>
            <input type="text" id="apiUrl" value="http://localhost:8000">
        </div>
        
        <!-- çŠ¶æ€æ˜¾ç¤º -->
        <div class="status" id="statusMessage"></div>
        
        <!-- ç»“æœæ˜¾ç¤º -->
        <div class="result-section">
            <h3 style="margin: 0 0 10px 0; color: #555;">ğŸ“Š æ£€æµ‹ç»“æœ</h3>
            <div id="resultsContainer">
                <div style="text-align: center; color: #999; padding: 20px; font-style: italic;">
                    é€‰æ‹©æ£€æµ‹æ¨¡å¼å¼€å§‹åˆ†æ
                </div>
            </div>
        </div>
    </div>
    
    <script src="popup.js"></script>
</body>
</html>